# 관계검정

* 변수와 변수의 관계를 검정
* 상관분석(Correlation Test) : 연속변수 + 연속변수
* 회귀분석(Regression) : 연속변수 + 연속변수
* 교차분석(test) : 질적변수 + 질적변수



## 1. 상관분석(Correlation Test)

### 1) 개요

* 상관분석은 관계성 개념에 주목하는 가장 기본적인 분석으로 이를 통해 1차적인 관계성을 확장해 고차원적인 관계성을 만들어줄 수 있음.
* 관계성이 있는 데이터를 취합했는지 확인하기 위해서 상관분석을 함
* 관계성이 가장 높은 변수를 주요 변수로 생각하며, 분석 결과에 따라서 추가적인 데이터 확보를 위한 일련의 과정이 모두 상관분석과 관련되어 있음.



### 2) 통계적 접근

* 상관관계 :  두 변수가 서로 동등한 입장에서 관계를 분석
  * 경향성을 의미함
  * Ex. 몸무게가 많이 나가면 허리둘레도 크고, 반대로 허리둘레가 크면 몸무게가 많이 나감
  * 편상관분석(Partial Correlation) : 중간에 다른 변수의 영향력이 있을 때 이를 통제

* 두 연속형 변수(구간/비율척도) 사이의 선형관계를 분석
  * 두 변수 간의 상호관계 파악
  * Ex. 홈런 개수와 연봉의 관계, 아버지의 키와 아들 키의 관계

* 상관 분석의 가정
  * 두 변수 $X$와 $Y$는 이변량 정규분포(bivariate normal distribution)을 따른다.
* $X$와 $Y$의 상관계수
  * X와 Y가 독립이라면, 상관계수는 0이다.
  * X, Y가 이변량정규분포를 하는 경우, 상관계수가 0이면, X, Y는 독립이다.



### 3) 가설검정

* 상관분석에 대한 가설(양측)은 다음과 같음
  * $H_0$ : 두 연속형 변수의 상관계수는 통계적으로 0이다. (상관관계가 없다) ($\rho=0$)
  * $H_1$ : 적어도 하나의 집단(요인수준)의 평균은 다르다.(상관관계가 있다.) $(\rho=0)$
  * p값 > 유의수준($\alpha$) -> $H_0$ 채택(accept) -> 상관관계가 없다.
  * p값 < 유의수준($\alpha$) -> $H_0$ 기각(reject) -> 상관관계가 있다.

* [상관계수 해석](https://namu.wiki/w/%EC%83%81%EA%B4%80%EA%B3%84%EC%88%98?from=%EC%83%81%EA%B4%80%20%EA%B3%84%EC%88%98)



#### - 상관관계 추론

1. 두 변수의 상관도(scatter plot)을 그려본다.
2. 가설 설정 
   * $H_0$ : $\rho=0$
   * $H_1$: $\rho=0$
3. 표본상관계수를 구한다.
4. 모상관계수에 대한 t-검정 실시
5. 결론



### - 편상관계수(Partial Correlations)

* 하나 또는 그 이상의 다른 양적변수를 통제하면서 두 개의 양적 변수 간의 관계



## 2. 회귀분석

### 1) 모델링과 예측

* 모델링(modeling)

  * 데이터로부터 모델을 알아내야 함.

  * 훈련 집합을 이용해 최적의 모델을 찾아내는 과정(훈련 집합을 가장 잘 설명하는 모델을 찾아내는 과정)

  * 현실 세계에서 일어나는 현상을 수학식으로 표현하는 행위

  * 모델링을 통해 모델을 알아내고 나면, 모델을 이용해 새로운 사실을 예측(prediction)할 수 있음.

  * 주어진 데이터를 **훈련 집합(training set)**이라 부름
    $$
    X = {x_1, x_2, \cdots, x_n}, Y = {y_1, y_2, \cdots, y_n}
    $$

  * $(x_i, y_i)$를 $i$번째 관측(observation) 또는 샘플(sample)이라 부름

  * 독립 변수 $x_i$를 **설명 변수(explanatory variable)** , **특징(feature)**

  * 종속 변수 $y_i$를 **반응 변수(response variable), 레이블(label)**



* 모델 선택(model selection)
  * 정보를 바탕으로 식을 수립하는 일
  * 모델 선택 직후에는 매개변수의 값은 모름
* 모델 적합(model fitting)
  * 훈련 집합을 가장 잘 설명하는 최적의 매개변수 값을 알아내는 과정
  * 학습(learning) 또는 훈련(training)이라고도 부름
  * 모델 적합으로 모델을 알아내면 예측이 가능
* 예측(prediction)
  * 모델을 가지고 훈련 집합에는 없는 새로운 샘플에 대해서 예측이 가능
* 모델의 품질 평가
  * 모델이 범하는 오류로 평가함



### 2) 회귀분석이란?

* 인과관계를 파악
* 하나 혹은 그 이상의 예측변수로부터, 반응변수를 예측하는 분석방법
  * 예측변수(= 설명변수, 독립변수)
  * 반응변수(= 결과변수, 종속변수)
* 회귀분석을 통해서,
  * 결과변수와 관련된 설명변수를 확인
  * 이들 간의 관계 형태를 기술
  * 설명변수로부터 결과변수를 예측하는 방정식을 구함.



#### - 회귀분석의 종류

| 회귀종류                                  | 주목적                                                       |
| ----------------------------------------- | ------------------------------------------------------------ |
| 단순선형<br>(Simple Linear)               | 하나의 양적 설명변수로부터 하나의 양적 반응변수를 예측       |
| 다항(Polynomial)                          | n차의 서열항으로 관련성을 모델화하고, 하나의 양적 설명변수로부터 하나의 양적 반응 변수를 예측 |
| 다중 선형<br>(Multiple Linear)            | 두 개 이상의 설명변수로부터 하나의 양적 반응변수를 예측      |
| 다차원(Multi-level)                       | 위계구조를 가진 데이터(Ex. 학생의 소속학급, 소속학교)로부터 하나의 반응변수를 예측, 위계적, 내재적 또는 혼합모델로 부름 |
| 다변량(Multivariable)                     | 하나 또는 둘 이상의 설명변수로부터 둘 이상의 반응 변수를 예측 |
| 로지스틱(Logistic)                        | 하나 또는 둘 이상의 설명변수로부터 하나의 **범주화된**반응변수를 예측 |
| 포아송(Poisson)                           | 하나 또는 둘 이상의 설명변수로부터 하나의 **서열화된**반응변수를 예측 |
| Cox비례위험<br>(Cox proportional hazards) | 하나 또는 둘 이상의 설명변수로부터 사건(죽음, 실패, 생존시간)을 예측 |
| 시계열(Time-Series)                       | 상관된 오차가 있는 데이터의 시계열성을 모델링                |
| 비선형(Non-Linear)                        | 모델 형태가 비선형적인 하나 또는 둘 이상의 설명변수로부터 하나의 반응변수를 예측 |
| 비모수적(Nonparametric)                   | 하나 또는 둘 이상의 설명변수로부터 반응변수를 예측 <br>모델은 선형적으로 특정화되지 않고 데이터로부터 도출 |
| 로버스트(Robust)                          | 하나 또는 둘 이상의 설명변수로부터 하나의 양적 반응변수를 예측<br>영향력 있는 관측치 효과에 저항하도록 설계 |



##### - OLS 회귀분석 종류

1. 단순회귀분석(Simple Regression Analysis)
   * 하나의 독립변수로 하나의 종속변수를 설명하는 모형
   * Ex. 아버지의 키로 한 자녀의 키를 설명하는 경우
2. 다중회귀분석(Multiple Regression Analysis)
   * 두 개 이쌍의 독립변수로 하나의 종속변수를 설명하는 모형
   * Ex. 아버지와 어머니의 키로 한 자녀의 키를 설명
3. 다항회귀분석(Polynomial Regression Analysis)
   * 독립변수와 종속변수의 관계를 2차 이상의 함수로 설명
   * Ex. 2차 함수관계 -> 독립변수 = $(x, x^2)$ -> 독립변수 간의 종속성에 주의
4. 다변량 회귀 분석(Multivariable Regression Analysis)
   * 두 개 이상의 종속변수를 사용하는 모형



#### - 회귀 모델과 가정

* OLS (Ordinary Least Squares) : 일반 최소자승법

  * OLS 회귀 모델

  $$
  Y_i = \beta_0\ +\ \beta_1X_{1i}\ +\ \beta_2X_{2i}+ \cdots \ +\ \beta_kX_{ki}+\epsilon_i\qquad i=1, \ldots, n
  $$

  * 가정
    * 정규성(Normality) : 독립변수의 고정된 값에 대해 종속변수는 정규분포를 한다.
    * 독립성(Independence) : $Y_i$ 값들은 상호독립적이어야 한다.
    * 선형성(Linearity) : 종속변수는 독립변수와 직선적 관계를 지닌다.
    * 등분산성(Homosedasticity) : 종속변수 $Y$의 분산이 대응하는 독립변수 $X$값의 차이에도 불구하고 모든 $X$값에 대해서 같아야 한다.